{
    "collab_server" : "",
    "contents" : "library(RSQLite)\nlibrary(sqldf)\nlibrary(lubridate)\nsource(\"creds.R\")\nsource(\"FacebookFunctions.R\")\n\n# download facebook page data and write to db\nfb_to_db <- function(dbConnection, fbPageName, authToken, dbTableName){\n  message(\"Fetching data\")\n  \n  page <- getPage(fbPageName, token, n = 2000)\n  page$created_time <- ymd_hms(page$created_time)\n  page$day_created <- day(page$created_time)\n  page$dow_created <- wday(page$created_time)\n  page$month_created <- month(page$created_time)\n  page$created_time <- gsub(\" UTC\", \"\", page$created_time)\n  \n  message(\"Disconnect from db before writing ...\")\n  readline(\"Press enter to write table to db:\")\n\n  dbWriteTable(conn = dbConnection, name = dbTableName, \n               value = page, overwrite = TRUE)\n}\n\n# set up authentication token\ntoken <- fbOAuth(app_id, app_secret)\n\n# set up connection to sqlite db\ndb <- dbConnect(RSQLite::SQLite(), dbname=\"omtm.sqlite\")\n\n# ----------------------------------------------------------\n#\n# writing various tables to sqlite database\n#\n#--------------------------------------------------------------\n\n# write fb data into db \n# ----------------------------------------------------------\nfb_to_db(db, \"DonaldTrump\", token, \"trump\")\nfb_to_db(db, \"Breitbart\", token, \"breitbart\")\nfb_to_db(db, \"FoxNews\", token, \"fox\")\nfb_to_db(db, \"foxandfriends\", token, \"faf\")\nfb_to_db(db, \"nytimes\", token, \"nyt\")\nfb_to_db(db, \"washingtonpost\", token, \"wp\")\nfb_to_db(db, \"cnn\", token, \"cnn\")\nfb_to_db(db, \"bbcnews\", token, \"bbc\")\nfb_to_db(db, \"TheEconomist\", token, \"economist\")\nfb_to_db(db, \"rs.sputniknews\", token, \"sputnik\")\nfb_to_db(db, \"CSPAN\", token, \"cspan\")\nfb_to_db(db, \"usatoday\", token, \"usatoday\")\nfb_to_db(db, \"theguardian\", token, \"theguardian\")\nfb_to_db(db, \"HuffingtonPost\", token, \"huffingtonpost\")\nfb_to_db(db, \"CBSNews\", token, \"cbs\")\nfb_to_db(db, \"mikepence\", token, \"pence\")\nfb_to_db(db, \"senatorsanders\", token, \"sanders\")\nfb_to_db(db, \"senatorelizabethwarren\", token, \"warren\")\nfb_to_db(db, \"billoreillyfnc\", token, \"oreilly\")\nfb_to_db(db, \"mikehuckabee\", token, \"huckabee\")\nfb_to_db(db, \"SeanHannity\", token, \"hannity\")\nfb_to_db(db, \"hillaryclinton\", token, \"clinton\")\n\n\n\n# extract data from posts and write them into new db tables\n# ----------------------------------------------------------\nExtractPostData(trumpsPosts) %>%\n  dbWriteTable(conn = db, name = \"posts\", overwrite = TRUE)\n\nExtractPostData(trumpsPosts, type=\"likes\") %>%\n  dbWriteTable(conn = db, name = \"postlikes\", overwrite = TRUE)\n\nExtractPostData(trumpsPosts, type=\"comments\") %>%\n  dbWriteTable(conn = db, name = \"postcomments\", overwrite = TRUE)\n\ndbDisconnect(db)\n",
    "created" : 1489161573703.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "7|71|22|0|\n",
    "hash" : "644685761",
    "id" : "1F066B9B",
    "lastKnownWriteTime" : 1489189572,
    "last_content_update" : 1490297401494,
    "path" : "D:/Projects/OMTM/deploy_sqlite.R",
    "project_path" : "deploy_sqlite.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}